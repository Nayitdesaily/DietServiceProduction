import{r as m,o as l,j as e,$ as U,c8 as Z,bZ as q,b_ as J,b$ as K,aa as G,cv as T,af as A,ag as P,aj as b,ab as F,au as le,bb as oe,av as ie,ai as ae,bW as pe,D as he,x as de,y as Y}from"./index.bc036284.js";import{T as te,a as ne,b as R,c as Q}from"./Tab.9daac559.js";import{Q as ue}from"./index.es.ad375045.js";import{m as ce}from"./mock.114ce5ac.js";import{u as re,C as O}from"./index.esm.58f04d6c.js";import{T as S}from"./App.b72e5e63.js";import{B as ee}from"./Box.b9eb146a.js";import"./emotion-react.browser.esm.cc46211b.js";import"./emotion-memoize.esm.06f0e458.js";import"./emotion-is-prop-valid.esm.22611268.js";import"./TransitionGroup.6175c5f8.js";function me({dietas:g,setDietas:x,editarCopiar:s,plan_id:V}){const[w,z]=m.exports.useState("1"),y=p=>{w===p?z():z(p)};function _(p,v){if(s=="Copiar"){const h=[...g];h.splice(p,1),x(h)}if(s=="Editar"){const h=[...g];v!=""?(b.delete(`https://dietservice.bitjoins.pe/api/dieta/eliminar/${V}/${p+1}`).then(E=>{console.log(E.data)}),h.splice(p,1),x(h)):(h.splice(p,1),x(h))}}function W(){x(p=>[...p,[{comida:"1",descripcion:"",id:"",opcion:(p.length+1).toString(),planalimentacion_id:""},{comida:"2",descripcion:"",id:"",opcion:(p.length+1).toString(),planalimentacion_id:""},{comida:"3",descripcion:"",id:"",opcion:(p.length+1).toString(),planalimentacion_id:""},{comida:"4",descripcion:"",id:"",opcion:(p.length+1).toString(),planalimentacion_id:""}]])}const[M,H]=m.exports.useState(null),N=p=>{H(p)},$=()=>{H(null)},D=(p,v,h)=>{const{value:E}=p.target;x(I=>I.map((k,j)=>j===v?k.map((r,u)=>u===h?{...r,descripcion:E}:r):k))};return l("div",{children:[e(U,{color:"success",onClick:()=>W(),children:"Agregar opcion"}),e("ul",{children:g.map((p,v)=>e("li",{style:{listStyle:"none"},children:e(Z,{open:w,toggle:y,style:{padding:0,margin:0},children:l(q,{children:[l("div",{style:{display:"flex",alignItems:"center"},children:[e(S,{size:20,onClick:()=>{var h;return _(v,(h=p==null?void 0:p[0])==null?void 0:h.id)},style:{color:M===v?"red":"black",cursor:"pointer"},onMouseEnter:()=>N(v),onMouseLeave:$}),l(J,{targetId:v,children:[" Opcion # ",v+1]})]}),e(K,{accordionId:v,children:p.map((h,E)=>e(G,{children:l(T,{children:[e(A,{children:h.comida==1?"Desayuno":h.comida==2?"Almuerzo":h.comida==3?"Cena":h.comida==4?"Merienda":null}),e(P,{name:"descripcion",placeholder:"Ingrese la comida",type:"textarea",defaultValue:h==null?void 0:h.descripcion,onChange:I=>D(I,v,E)})]})},E))})]})})},v))})]})}function ge({planSeleccionado:g,dietas:x,setDietas:s,recomendaciones:V,setRecomendaciones:w,ejercicios:z,setEjercicios:y,patologia:_,setPatologia:W,editarCopiar:M}){const[H,N]=m.exports.useState("dieta"),{control:$}=re({}),[D,p]=m.exports.useState(null),[v,h]=m.exports.useState("1"),E=(t,n)=>{N(n)};m.exports.useEffect(()=>{async function t(){await b.get(`https://dietservice.bitjoins.pe/api/plan-alimentacion/dietas/web/${g==null?void 0:g.planalimentacion_id}`).then(n=>{s(n.data)}),await b.get(`https://dietservice.bitjoins.pe/api/recomendaciones-web/${g==null?void 0:g.planalimentacion_id}`).then(n=>{w(n.data)}),await b.get(`https://dietservice.bitjoins.pe/api/ejercicios-web/${g==null?void 0:g.planalimentacion_id}`).then(n=>{y(n.data)}),await b.get(`https://dietservice.bitjoins.pe/api/patologias-web/${g==null?void 0:g.planalimentacion_id}`).then(n=>{W(n.data)})}t()},[]),m.exports.useEffect(()=>{M=="Copiar"&&(_==null||_.map(t=>{t.patologia_por_plan_id=""}))},_);const I=t=>{v===t?h():h(t)},k=t=>{p(t)},j=()=>{p(null)},r=(t,n)=>{const{value:i}=t.target;w(C=>C.map((d,B)=>B===n?{...d,recomendacion:i}:d))},u=(t,n)=>{const{value:i}=t.target;w(C=>C.map((d,B)=>B===n?{...d,tipo:i}:d))};function a(){w(t=>[...t,{recomendacion:"",id:"",tipo:"",planalimentacion_id:""}])}const o=(t,n)=>{const{value:i}=t.target;y(C=>C.map((d,B)=>B===n?{...d,tipoejercicio:i}:d))},c=(t,n)=>{const{value:i}=t.target;y(C=>C.map((d,B)=>B===n?{...d,tiempo:i}:d))},f=(t,n)=>{const{value:i}=t.target;y(C=>C.map((d,B)=>B===n?{...d,observaciones:i}:d))};function L(){y(t=>[...t,{tipoejercicio:"",id:"",tiempo:"",planalimentacion_id:"",observaciones:""}])}console.log(_);function X(t,n){const i=[...V];M=="Copiar"&&(i.splice(t,1),w(i)),M=="Editar"&&(n!=""?(b.delete(`https://dietservice.bitjoins.pe/api/recomendaciones/eliminar/${n}`).then(C=>{console.log(C.data)}),i.splice(t,1),w(i)):(i.splice(t,1),w(i)))}function se(t,n){const i=[...z];M=="Copiar"&&(i.splice(t,1),y(i)),M=="Editar"&&(n!=""?(b.delete(`https://dietservice.bitjoins.pe/api/ejercicios/eliminar/${n}`).then(C=>{console.log(C.data)}),i.splice(t,1),y(i)):(i.splice(t,1),y(i)))}return e("div",{children:e(ee,{sx:{width:"100%",typography:"body1"},children:l(te,{value:H,children:[e(ee,{sx:{borderBottom:1,borderColor:"divider"},children:l(ne,{onChange:E,"aria-label":"lab API tabs example",children:[e(R,{label:"Dieta",value:"dieta"}),e(R,{label:"Recomendaciones",value:"recomendaciones"}),e(R,{label:"Ejercicios",value:"ejercicios"}),e(R,{label:"Patologia",value:"patologia"})]})}),e(Q,{value:"dieta",children:e(me,{dietas:x,setDietas:s,editarCopiar:M,plan_id:g==null?void 0:g.planalimentacion_id})}),l(Q,{value:"recomendaciones",children:[e(U,{color:"success",onClick:()=>a(),children:"Agregar opcion"}),e("ul",{children:V.map((t,n)=>e("li",{style:{listStyle:"none"},children:e(Z,{open:v,toggle:I,style:{padding:0,margin:0},children:l(q,{children:[l("div",{style:{display:"flex",alignItems:"center"},children:[e(S,{size:20,onClick:()=>X(n,t==null?void 0:t.id),style:{color:D===n?"red":"black",cursor:"pointer"},onMouseEnter:()=>k(n),onMouseLeave:j}),l(J,{targetId:n,children:[" Opcion ",n+1]})]}),e(K,{accordionId:n,children:l(G,{children:[e(F,{children:e(O,{name:"tipo",control:$,render:({field:{onChange:i,value:C}})=>l(T,{children:[e(A,{children:"Tipo"}),l(P,{placeholder:"Ingrese el tipo",type:"select",defaultValue:t==null?void 0:t.tipo,onChange:d=>{u(d,n),i(d.target.value)},children:[e("option",{value:"",children:"Seleccione el tipo"}),e("option",{value:"1",children:"Pautas Generales"}),e("option",{value:"2",children:"Alimentos Prohibidos"}),e("option",{value:"3",children:"Prohibidos (Consumo Mensual)"}),e("option",{value:"4",children:"No olvidar"})]})]})})}),e(F,{children:e(O,{name:"recomendacion",control:$,render:({field:{onChange:i,value:C}})=>e(T,{children:e(P,{placeholder:"Ingrese la recomendacion",type:"textarea",onChange:d=>{r(d,n),i(d.target.value)},defaultValue:t==null?void 0:t.recomendacion})})})})]})})]})})},n))})]}),l(Q,{value:"ejercicios",children:[e(U,{color:"success",onClick:()=>L(),children:"Agregar opcion"}),e("ul",{children:z.map((t,n)=>e("li",{style:{listStyle:"none"},children:e(Z,{open:v,toggle:I,style:{padding:0,margin:0},children:l(q,{children:[l("div",{style:{display:"flex",alignItems:"center"},children:[e(S,{size:20,onClick:()=>se(n,t==null?void 0:t.id),style:{color:D===n?"red":"black",cursor:"pointer"},onMouseEnter:()=>k(n),onMouseLeave:j}),l(J,{targetId:n,children:[" Opcion ",n+1]})]}),e(K,{accordionId:n,children:l(G,{children:[e(F,{children:e(O,{name:"tipoejercicio",control:$,render:({field:{onChange:i,value:C}})=>l(T,{children:[e(A,{children:"Tipo Ejercicio"}),e(P,{placeholder:"Ingrese el tipo",type:"text",defaultValue:t==null?void 0:t.tipoejercicio,onChange:d=>{o(d,n),i(d.target.value)}})]})})}),e(F,{children:e(O,{name:"tiempo",control:$,render:({field:{onChange:i,value:C}})=>l(T,{children:[e(A,{children:"Tiempo"}),e(P,{placeholder:"Ingrese la recomendacion",type:"textarea",onChange:d=>{c(d,n),i(d.target.value)},defaultValue:t==null?void 0:t.tiempo})]})})}),e(F,{children:e(O,{name:"observaciones",control:$,render:({field:{onChange:i,value:C}})=>l(T,{children:[e(A,{children:"Observaciones"}),e(P,{placeholder:"Ingrese la recomendacion",type:"textarea",onChange:d=>{f(d,n),i(d.target.value)},defaultValue:t==null?void 0:t.observaciones})]})})})]})})]})})},n))})]}),e(Q,{value:"patologia",children:_.length<1?"No tiene patologias":e("ul",{children:_==null?void 0:_.map((t,n)=>e("li",{style:{listStyle:"none"},children:e(Z,{open:v,toggle:I,style:{padding:0,margin:0},children:l(q,{children:[l(J,{targetId:n,children:[" ",t.nombre]}),e(K,{accordionId:n,children:e("div",{dangerouslySetInnerHTML:{__html:t.descripcion}})})]})})},n))})})]})})})}function ve({modal:g,toggle:x,filaSeleccionada:s,setFilaSeleccionada:V,editarCopiar:w}){const{handleSubmit:z,control:y,reset:_}=re({}),[W,M]=m.exports.useState([]),[H,N]=m.exports.useState([]),[$,D]=m.exports.useState([]),[p,v]=m.exports.useState([]),[h,E]=m.exports.useState([]),[I,k]=m.exports.useState([]);async function j(r){w=="Copiar"&&await b.post("https://dietservice.bitjoins.pe/api/plan_alimentacion/create_web",r).then(u=>{var a,o;if(u.status=200){console.log(u);const c=(o=(a=u==null?void 0:u.data)==null?void 0:a.data)==null?void 0:o.id;W.map(f=>{f.map(L=>{L.planalimentacion_id=c.toString(),b.post("https://dietservice.bitjoins.pe/api/dieta/create",L).then(X=>console.log(X))})}),H.map(f=>{f.planalimentacion_id=c.toString(),b.post("https://dietservice.bitjoins.pe/api/recomendaciones/create",f).then(L=>console.log(L))}),$.map(f=>{f.planalimentacion_id=c.toString(),b.post("https://dietservice.bitjoins.pe/api/ejercicios/create",f).then(L=>console.log(L))}),I==null||I.map(f=>{f.planalimentacion_id=c.toString(),b.post("https://dietservice.bitjoins.pe/api/crear-patologia-web",f).then(L=>{console.log(L)})})}}),w=="Editar"&&await b.put(`https://dietservice.bitjoins.pe/api/plan_alimentacion/actualizar/${s==null?void 0:s.planalimentacion_id}`,r).then(u=>{if(u.status=200){console.log(u.data);const a=s==null?void 0:s.planalimentacion_id;W.map(o=>{o.map(c=>{c.planalimentacion_id=a.toString(),(c==null?void 0:c.id)!==""?b.put(`https://dietservice.bitjoins.pe/api/dieta/actualizar/${c==null?void 0:c.id}`,c).then(f=>console.log(f.data.message)):b.post("https://dietservice.bitjoins.pe/api/dieta/create",c).then(f=>console.log(f.data.message))})}),H.map(o=>{o.planalimentacion_id=a.toString(),(o==null?void 0:o.id)!=""?b.put(`https://dietservice.bitjoins.pe/api/recomendaciones/actualizar/${o==null?void 0:o.id}`,o).then(c=>console.log(c.data)):b.post("https://dietservice.bitjoins.pe/api/recomendaciones/create",o).then(c=>console.log(c.data.message))}),$.map(o=>{o.planalimentacion_id=a.toString(),(o==null?void 0:o.id)!=""?b.put(`https://dietservice.bitjoins.pe/api/ejercicios/actualizar/${o==null?void 0:o.id}`,o).then(c=>console.log(c.data.message)):b.post("https://dietservice.bitjoins.pe/api/ejercicios/create",o).then(c=>console.log(c.data.message))}),I==null||I.map(o=>{o.planalimentacion_id=a.toString(),o.patologia_por_plan_id==""&&b.post("https://dietservice.bitjoins.pe/api/crear-patologia-web",o).then(c=>{console.log(c)})})}}),x()}return m.exports.useEffect(()=>{async function r(){await b.get("https://dietservice.bitjoins.pe/api/nutricionistas").then(u=>{v(u.data)}),await b.get("https://dietservice.bitjoins.pe/api/usuarios-web").then(u=>{E(u.data)})}r()},[]),e("div",{children:l(le,{isOpen:g,toggle:()=>{x(),M([]),N([]),D([]),k([]),_(),V({})},fullscreen:!0,scrollable:!0,children:[e(oe,{toggle:()=>{x(),M([]),N([]),D([]),k([]),_(),V({})},children:"Modal title"}),e(ie,{children:l("form",{onSubmit:z(j),children:[e(G,{children:e(O,{name:"fecultimaact",control:y,render:({field:{value:r,...u}})=>l(T,{children:[e(A,{children:"Fecha"}),e(P,{placeholder:"Ingrese la fecha de inicio",type:"date",...u})]})})}),e(G,{children:e(O,{name:"nombre",control:y,defaultValue:s==null?void 0:s.plan,render:({field:r})=>l(T,{children:[e(A,{children:"Plan"}),e(P,{placeholder:"Ingrese el nombre del plan",type:"text",...r})]})})}),l(G,{children:[e(F,{children:e(O,{name:"usuario_id",control:y,defaultValue:s==null?void 0:s.usuario_id,render:({field:{onChange:r,value:u}})=>l(T,{children:[e(A,{children:"Cliente"}),l(P,{placeholder:"Seleccione el cliente",type:"select",onChange:a=>r(a.target.value),children:[l("option",{value:s==null?void 0:s.usuario_id,children:[s==null?void 0:s.nombre," ",s==null?void 0:s.apellido]}),h==null?void 0:h.filter(a=>a.usuario_id!=(s==null?void 0:s.usuario_id)).map((a,o)=>l("option",{value:a==null?void 0:a.usuario_id,children:[a==null?void 0:a.nombre," ",a==null?void 0:a.apellido]},o))]})]})})}),e(F,{children:e(O,{name:"nutricionista_id",control:y,defaultValue:s==null?void 0:s.nutricionista_id,render:({field:{onChange:r,value:u}})=>l(T,{children:[e(A,{children:"Nutricionista"}),l(P,{placeholder:"Seleccione el nutricionista",type:"select",onChange:a=>r(a.target.value),children:[e("option",{value:s==null?void 0:s.nutricionista_id,children:s==null?void 0:s.nutricionista_nombres}),p==null?void 0:p.map((a,o)=>e("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.nombres},o))]})]})})})]}),l(G,{children:[e(F,{children:e(O,{name:"tips",control:y,defaultValue:s==null?void 0:s.tips,render:({field:r})=>l(T,{children:[e(A,{children:"Tips"}),e(P,{placeholder:"Ingrese el tip",type:"textarea",...r})]})})}),e(F,{children:e(O,{name:"notas",control:y,defaultValue:s==null?void 0:s.notas,render:({field:r})=>l(T,{children:[e(A,{children:"Notas"}),e(P,{placeholder:"Ingresa las notas",type:"textarea",...r})]})})})]}),e(ge,{planSeleccionado:s,dietas:W,setDietas:M,recomendaciones:H,setRecomendaciones:N,ejercicios:$,setEjercicios:D,patologia:I,setPatologia:k,editarCopiar:w}),e(U,{color:"success",type:"submit",children:"Ok"}),e(U,{color:"secondary",onClick:()=>{x(),_(),V({})},children:"Cancel"})]})})]})})}function be({direction:g}){ce.restore();const[x,s]=m.exports.useState("historico"),[V,w]=m.exports.useState([]),[z,y]=m.exports.useState(!0),[_,W]=m.exports.useState(!1),[M,H]=m.exports.useState(null),[N,$]=m.exports.useState({}),[D,p]=m.exports.useState(!1),v=()=>p(!D),[h,E]=m.exports.useState(""),I=r=>{M===r?W(!_):(W(!0),H(r))};m.exports.useEffect(()=>{async function r(){await b.get("https://dietservice.bitjoins.pe/api/plan_alimentacion").then(u=>{w(u.data)}),y(!1)}r()},[]);const k=(r,u)=>{s(u)},j=[{cell:r=>l(pe,{isOpen:_&&M===r,toggle:()=>I(r),direction:g,children:[e(he,{caret:!0,children:"Opciones"}),l(de,{children:[e(Y,{children:"Detalle"}),e(Y,{onClick:()=>{v(),E("Editar"),$(r)},children:"Editar"}),e(Y,{onClick:()=>{v(),$(r),E("Copiar")},children:"Copiar"})]})]})},{name:"Item",selector:(r,u)=>u+1,center:!0,maxWidth:"2rem"},{name:"Plan",selector:r=>r.plan,minWidth:"12rem",sortable:!0},{name:"Estado",selector:r=>r.estado,minWidth:"12rem",sortable:!0},{name:"Cliente",selector:r=>`${r.nombre} ${r.apellido}`,minWidth:"12rem",sortable:!0},{name:"Usuario",selector:r=>r.email,minWidth:"12rem",sortable:!0},{name:"Distrito",selector:r=>r.estado,minWidth:"12rem",sortable:!0},{name:"Fecha",selector:r=>r.fecultimaact,minWidth:"12rem",sortable:!0},{name:"Nutricionista",selector:r=>r.nutricionista_nombres,minWidth:"12rem",sortable:!0},{name:"Contacto",selector:r=>r.contacto,minWidth:"12rem",sortable:!0}];return e("div",{children:e(m.exports.Fragment,{children:l(te,{value:x,children:[l(ne,{onChange:k,"aria-label":"simple tabs example",children:[e(R,{value:"historico",label:"Historico"}),e(R,{value:"plan",label:"Plan"}),e(R,{value:"galeria",label:"Galeria"})]}),l(Q,{value:"historico",children:[e(ue,{columns:j,data:V,pagination:!0,noDataComponent:"No hay data",progressPending:z,progressComponent:e(ae,{children:"Loading..."})}),e(ve,{modal:D,toggle:v,filaSeleccionada:N,setFilaSeleccionada:$,editarCopiar:h})]}),e(Q,{value:"plan"}),e(Q,{value:"galeria"})]})})})}be.propTypes={direction:"down"};export{be as default};
